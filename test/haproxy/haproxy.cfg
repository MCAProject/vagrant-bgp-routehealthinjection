global
  log stdout format raw local0

defaults
  timeout connect 10s
  timeout client 30s
  timeout server 30s
  mode http
  log global

frontend virutal-server
  bind *:80
  mode http
  option httplog
  default_backend backend-pod

backend backend-pod
  balance roundrobin
  mode http
  server-template k8s-nginx-pod 10 _http._tcp.headless-service.default.svc.cluster.local resolvers k8s_dns resolve-opts allow-dup-ip resolve-prefer ipv4 check

resolvers k8s_dns
  nameserver dns1 10.11.0.10:53
  hold valid 	       30s
  accepted_payload_size 8192

